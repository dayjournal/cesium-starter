import Check from"../../Core/Check.js";import defaultValue from"../../Core/defaultValue.js";import defined from"../../Core/defined.js";import destroyObject from"../../Core/destroyObject.js";import knockout from"../../ThirdParty/knockout.js";import getElement from"../getElement.js";import InspectorShared from"../InspectorShared.js";import Cesium3DTilesInspectorViewModel from"./Cesium3DTilesInspectorViewModel.js";function Cesium3DTilesInspector(e,t){Check.defined("container",e),Check.typeOf.object("scene",t),e=getElement(e);const i=document.createElement("div"),n=document.createElement("div");n.setAttribute("data-bind","visible: performance");const a=new Cesium3DTilesInspectorViewModel(t,n);this._viewModel=a,this._container=e,this._element=i;const o=document.createElement("div");o.textContent="3D Tiles Inspector",o.className="cesium-cesiumInspector-button",o.setAttribute("data-bind","click: toggleInspector"),i.appendChild(o),i.className="cesium-cesiumInspector cesium-3DTilesInspector",i.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(i);const d=document.createElement("div");this._panel=d,d.className="cesium-cesiumInspector-dropDown",i.appendChild(d);const s=InspectorShared.createSection,c=InspectorShared.createCheckbox,r=s(d,"Tileset","tilesetVisible","toggleTileset"),l=s(d,"Display","displayVisible","toggleDisplay"),p=s(d,"Update","updateVisible","toggleUpdate"),m=s(d,"Logging","loggingVisible","toggleLogging"),u=s(d,"Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels"),h=s(d,"Style","styleVisible","toggleStyle"),C=s(d,"Optimization","optimizationVisible","toggleOptimization"),g=document.createElement("div");g.className="field-group";const b=document.createElement("label");b.className="field-label",b.appendChild(document.createTextNode("Properties: "));const S=document.createElement("div");S.setAttribute("data-bind","text: properties"),g.appendChild(b),g.appendChild(S),r.appendChild(g),r.appendChild(makeButton("togglePickTileset","Pick Tileset","pickActive")),r.appendChild(makeButton("trimTilesCache","Trim Tiles Cache")),r.appendChild(c("Enable Picking","picking")),l.appendChild(c("Colorize","colorize")),l.appendChild(c("Wireframe","wireframe")),l.appendChild(c("Bounding Volumes","showBoundingVolumes")),l.appendChild(c("Content Volumes","showContentBoundingVolumes")),l.appendChild(c("Request Volumes","showRequestVolumes")),l.appendChild(c("Point Cloud Shading","pointCloudShading"));const E=document.createElement("div");E.setAttribute("data-bind","visible: pointCloudShading"),E.appendChild(makeRangeInput("geometricErrorScale",0,2,.01,"Geometric Error Scale")),E.appendChild(makeRangeInput("maximumAttenuation",0,32,1,"Maximum Attenuation")),E.appendChild(makeRangeInput("baseResolution",0,1,.01,"Base Resolution")),E.appendChild(c("Eye Dome Lighting (EDL)","eyeDomeLighting")),l.appendChild(E);const k=document.createElement("div");k.setAttribute("data-bind","visible: eyeDomeLighting"),k.appendChild(makeRangeInput("eyeDomeLightingStrength",0,2,.1,"EDL Strength")),k.appendChild(makeRangeInput("eyeDomeLightingRadius",0,4,.1,"EDL Radius")),E.appendChild(k),p.appendChild(c("Freeze Frame","freezeFrame")),p.appendChild(c("Dynamic Screen Space Error","dynamicScreenSpaceError"));const y=document.createElement("div");y.appendChild(makeRangeInput("maximumScreenSpaceError",0,128,1,"Maximum Screen Space Error")),p.appendChild(y);const v=document.createElement("div");v.setAttribute("data-bind","visible: dynamicScreenSpaceError"),v.appendChild(makeRangeInput("dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"Screen Space Error Density","dynamicScreenSpaceErrorDensity")),v.appendChild(makeRangeInput("dynamicScreenSpaceErrorFactor",1,10,.1,"Screen Space Error Factor")),p.appendChild(v),m.appendChild(c("Performance","performance")),m.appendChild(n),m.appendChild(c("Statistics","showStatistics"));const I=document.createElement("div");I.className="cesium-3dTilesInspector-statistics",I.setAttribute("data-bind","html: statisticsText, visible: showStatistics"),m.appendChild(I),m.appendChild(c("Pick Statistics","showPickStatistics"));const f=document.createElement("div");f.className="cesium-3dTilesInspector-statistics",f.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics"),m.appendChild(f);const D=document.createElement("div");h.appendChild(D),D.appendChild(document.createTextNode("Color Blend Mode: "));const T=document.createElement("select");T.setAttribute("data-bind",'options: colorBlendModes, optionsText: "text", optionsValue: "value", value: colorBlendMode'),D.appendChild(T);const w=document.createElement("textarea");w.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }"),D.className="cesium-cesiumInspector-styleEditor",D.appendChild(w);const V=makeButton("compileStyle","Compile (Ctrl+Enter)");D.appendChild(V);const L=document.createElement("div");L.className="cesium-cesiumInspector-error",L.setAttribute("data-bind","text: editorError"),D.appendChild(L),u.appendChild(c("Show Picked Only","showOnlyPickedTileDebugLabel")),u.appendChild(c("Geometric Error","showGeometricError")),u.appendChild(c("Rendering Statistics","showRenderingStatistics")),u.appendChild(c("Memory Usage (MB)","showMemoryUsage")),u.appendChild(c("Url","showUrl")),C.appendChild(c("Skip Tile LODs","skipLevelOfDetail"));const x=document.createElement("div");x.appendChild(makeRangeInput("skipScreenSpaceErrorFactor",1,50,1,"Skip SSE Factor")),C.appendChild(x);const R=document.createElement("div");R.appendChild(makeRangeInput("baseScreenSpaceError",0,4096,1,"SSE before skipping LOD")),C.appendChild(R);const A=document.createElement("div");A.appendChild(makeRangeInput("skipLevels",0,10,1,"Min. levels to skip")),C.appendChild(A),C.appendChild(c("Load only tiles that meet the max SSE.","immediatelyLoadDesiredLevelOfDetail")),C.appendChild(c("Load siblings of visible tiles","loadSiblings")),knockout.applyBindings(a,i)}function makeRangeInput(e,t,i,n,a,o){o=defaultValue(o,e);const d=document.createElement("input");d.setAttribute("data-bind",`value: ${o}`),d.type="number";const s=document.createElement("input");s.type="range",s.min=t,s.max=i,s.step=n,s.setAttribute("data-bind",`valueUpdate: "input", value: ${e}`);const c=document.createElement("div");c.appendChild(s);const r=document.createElement("div");return r.className="cesium-cesiumInspector-slider",r.appendChild(document.createTextNode(a)),r.appendChild(d),r.appendChild(c),r}function makeButton(e,t,i){const n=document.createElement("button");n.type="button",n.textContent=t,n.className="cesium-cesiumInspector-pickButton";let a=`click: ${e}`;return defined(i)&&(a+=`, css: {"cesium-cesiumInspector-pickButtonHighlight" : ${i}}`),n.setAttribute("data-bind",a),n}Object.defineProperties(Cesium3DTilesInspector.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),Cesium3DTilesInspector.prototype.isDestroyed=function(){return!1},Cesium3DTilesInspector.prototype.destroy=function(){return knockout.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),destroyObject(this)};export default Cesium3DTilesInspector;